<!DOCTYPE html>
<html lang="en-us">

  <head>
  <meta charset="utf-8">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Comparison of changepoint detection methods</title>
  <meta name="author" content="" />

  
  <meta name="keywords" content="marine, data, R">
  

  
  <meta name="description" content="Site template made by Saskia using hugo">
  

  <meta name="generator" content="Hugo 0.49" />

  
  


  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous">
  
  
  <link rel="stylesheet" href="/css/academicons.min.css" >


  
  
  

  <link rel="apple-touch-icon" sizes="180x180" href="/img/favicons/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/img/favicons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/img/favicons/favicon-16x16.png">
  <link rel="manifest" href="/img/favicons/site.webmanifest">
  <link rel="mask-icon" href="/img/favicons/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#0f1f25">
  <meta name="theme-color" content="#ffffff">


  
  <meta property="og:title" content="Comparison of changepoint detection methods" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="/blog/2019/05/21/comparison-of-changepoint-detection-methods//" />
  <meta property="og:image" content="img/mds_logo_notext@2x.png" />

  
  <link href="/css/owl.carousel.css" rel="stylesheet">
  <link href="/css/owl.theme.css" rel="stylesheet">

  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="Marine Data Science">

  
  
  <link rel="stylesheet" href="/css/bootstrap.css" >


  
  
  
  <link rel="stylesheet" href="/css/atom-one-dark_custom.css" rel="stylesheet" id="theme-stylesheet">


  
  <link href="/css/animate.css" rel="stylesheet">


  
  <link href="/css/style.blue_custom.css" rel="stylesheet" id="theme-stylesheet">


</head>


  <body>

    <div id="all">

        <header>

          
          
<div id="top">
  <div class="container">
    <div class="row">
      <div class="col-xs-5">
        
      </div>
      <div class="col-xs-7">
        <div class="social">
          
          <a href="https://saskiaotto.de" target="_blank" style="opacity: 1;"><i class='fas fa-2x fa-globe'></i></a>
          
          <a href="https://github.com/mareds" target="_blank" style="opacity: 1;"><i class='fab fa-2x fa-github'></i></a>
          
          <a href="https://github.com/saskiaotto" target="_blank" style="opacity: 1;"><i class='fab fa-2x fa-github'></i></a>
          
          <a href="https://www.researchgate.net/profile/Saskia_Otto" target="_blank" style="opacity: 1;"><i class='fab fa-2x fa-researchgate'></i></a>
          
          <a href="https://orcid.org/0000-0001-7780-1322" target="_blank" style="opacity: 1;"><i class='ai ai-2x ai-orcid'></i></a>
          
          <a href="mailto:saskia.otto@uni-hamburg.de" target="_blank" style="opacity: 1;"><i class='fa fa-2x fa-envelope'></i></a>
          
        </div>
      </div>
    </div>
  </div>
</div>



          <div class="navbar-affixed-top" data-spy="affix" data-offset-top="200">

    <div class="navbar navbar-default yamm" role="navigation" id="navbar">

        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand home" href="/">
                    <img src="/img/mds_logo_notext@2x.png" alt="Comparison of changepoint detection methods logo" class="hidden-xs hidden-sm" style="max-height:50px;">
                    <img src="/img/mds_logo_notext_small.png" alt="Comparison of changepoint detection methods logo" class="visible-xs visible-sm" style="max-height:40px;">
                    <span class="sr-only">Comparison of changepoint detection methods - go to homepage</span>
                </a>
                <div class="navbar-buttons">
                    <button type="button" class="navbar-toggle btn-template-main" data-toggle="collapse" data-target="#navigation">
                      <span class="sr-only">Toggle Navigation</span>
                        <i class="fa fa-align-justify"></i>
                    </button>
                </div>
            </div>
            

            <div class="navbar-collapse collapse" id="navigation">
                <ul class="nav navbar-nav navbar-right">

                  

                  

                  
                  <li class="" title="Home">
                        <a href="/">Home</a>
                      </li>
                  <li class="" title="MDS">
                        <a href="/mds/">MDS</a>
                      </li>
                  <li class="active" title="Blog">
                        <a href="/blog/">Blog</a>
                      </li>
                  <li class="" title="Courses">
                        <a href="/courses/">Courses</a>
                      </li>
                  <li class="" title="Data">
                        <a href="/data/">Data</a>
                      </li>
                  <li class="" title="Software">
                        <a href="/software/">Software</a>
                      </li>
                  <li class="" title="About">
                        <a href="/about/">About</a>
                      </li>
                  <li class="" title="Contact">
                        <a href="/contact/">Contact</a>
                      </li>
                  

                </ul>
            </div>
            

            <div class="collapse clearfix" id="search">

                <form class="navbar-form" role="search">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search">
                        <span class="input-group-btn">

                    <button type="submit" class="btn btn-template-main"><i class="fa fa-search"></i></button>

                </span>
                    </div>
                </form>

            </div>
            

        </div>
    </div>
    

</div>




        </header>

        <div id="heading-breadcrumbs">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                  <h1 class="title toc-ignore">Comparison of changepoint detection methods</h1>
            </div>
        </div>
    </div>
</div>


        <div id="content">
            <div class="container">

                <div class="row">

                    

                    <div class="col-md-9" id="blog-post">

                        <p class="text-muted text-uppercase mb-small text-right">By <a href="#">Saskia</a> | May 21, 2019</p>

                        <div id="post-content">
                          <ul>
<li><code>changepoint</code>: changes in mean and variance of time series</li>
<li><code>bcp</code>: changes in mean; Bayesian approach</li>
<li><code>strucchange</code>: changes in (time series) regression model</li>
<li><code>segmented</code>: changes in regression (does not have to be time series data)</li>
<li><code>tree</code>: classication</li>
</ul>
<!-- the changepoint package (Killick and Eckley, 2011) provides many methods for performing change point analysis of univariate time series. Although the package only considers the case of independent observations, the theory behind the implemented methods allows for certain types of serial dependence (Killick et al., 2012). For specific methods, the expected computational cost can be shown to be linear with respect to the length of the time series. Currently, the changepoint package is only suitable for finding changes in mean or variance. This package also estimates multiple change points through the use of penalization. The drawback to this approach is that it requires a user specified penalty term. -->
<!-- The strucchange package (Zeileis et al., 2002) provides a suite of tools for detecting changes within linear regression models. Many of these tools however, focus on detecting at most one change within the regression model. This package also contains methods that perform online change detection, thus allowing it to be used in settings where there are multiple changes. Addi- tionally, if the number of changes is known a priori then the breakpoints method (Zeileis et al., 2003) can be used to perform retrospective analysis. For a given number of changes, this method returns the change point estimates which minimize the residual sum of squares. -->
<!-- the bcp package (Erdman and Emerson, 2007) is designed to perform Bayesian single change point analysis of univariate time series. It returns the posterior probability of a change point occurring at each time index in the series. Recent versions of this package have reduced the computational cost from quadratic to linear with respect to the length of the series. However, all versions of this package are only designed to detect changes in the mean of independent Gaussian observations. -->
<div id="overview" class="section level2">
<h2>Overview</h2>
<ul>
<li><a href="#detection-performance-under-different-scenarios">Detection performance under different scenarios</a>
<ul>
<li><a href="#change-in-mean">1 change in mean</a>
<ul>
<li><a href="#real-data-nile-dataset">Real data: <strong>Nile</strong> dataset</a></li>
<li><a href="#artificial-data">Artificial data</a></li>
</ul></li>
<li><a href="#changes-in-mean">3 changes in mean</a></li>
<li><a href="#break-in-relationship">1 break in relationship</a></li>
<li><a href="#cubic-decay-function">Cubic decay function</a></li>
<li><a href="#highly-non-linear-3-changes-in-regression">Highly non-linear (3 changes in regression)</a></li>
</ul></li>
<li><a href="#conclusion">Conclusion</a>
<ul>
<li><a href="#changes-in-mean">Changes in mean:</a></li>
<li><a href="#changes-in-functional-curves-of-relatioships-between-y-and-x">Changes in functional curves of relatioships between Y and X:</a></li>
</ul></li>
</ul>
</div>
<div id="detection-performance-under-different-scenarios" class="section level1">
<h1>Detection performance under different scenarios</h1>
<pre class="r"><code># Loading packages
library(changepoint)
library(bcp)
library(strucchange)
library(segmented)
library(tree)</code></pre>
<div id="change-in-mean" class="section level2">
<h2>1 change in mean</h2>
<div id="real-data-nile-dataset" class="section level3">
<h3>Real data: <strong>Nile</strong> dataset</h3>
<p>The Nile dataset comes with the R <code>dataset</code> package and represents measurements of the annual flow (in unit 10<sup>8</sup> m<sup>3</sup>) of the river Nile at Aswan (formerly Assuan), between 1871 and 1970. Around 1898, the annual flow dropped greatly from circa 1100 to 800<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>. We will test now whether this shift will be detected by all 5 methods.</p>
<pre class="r"><code>data(Nile)
str(Nile)</code></pre>
<pre><code>##  Time-Series [1:100] from 1871 to 1970: 1120 1160 963 1210 1160 1160 813 1230 1370 1140 ...</code></pre>
<pre class="r"><code>plot(Nile)</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div id="changepoint" class="section level4">
<h4>changepoint</h4>
<p>Looking for 1 changepoint, using default setting</p>
<pre class="r"><code>cpt_nile1 &lt;- cpt.mean(Nile, method = &quot;AMOC&quot;) 
cpt_nile1@cpts</code></pre>
<pre><code>## [1]  28 100</code></pre>
<p>Looking for multiple changepoints</p>
<pre class="r"><code>cpt.mean(Nile, method = &quot;PELT&quot;, Q = 10)</code></pre>
<pre><code>## Class &#39;cpt&#39; : Changepoint Object
##        ~~   : S4 class containing 12 slots with names
##               cpttype date version data.set method test.stat pen.type pen.value minseglen cpts ncpts.max param.est 
## 
## Created on  : Mon Apr 23 00:37:43 2018 
## 
## summary(.)  :
## ----------
## Created Using changepoint version 2.2.2 
## Changepoint type      : Change in mean 
## Method of analysis    : PELT 
## Test Statistic  : Normal 
## Type of penalty       : MBIC with value, 13.81551 
## Minimum Segment Length : 1 
## Maximum no. of cpts   : Inf 
## Number of changepoints: 94</code></pre>
<pre class="r"><code>cpt.mean(Nile, method = &quot;PELT&quot;, penalty = &quot;CROPS&quot;, pen.value = c(1,25))</code></pre>
<pre><code>## [1] &quot;Maximum number of runs of algorithm = 6&quot;
## [1] &quot;Completed runs = 2&quot;
## [1] &quot;Completed runs = 3&quot;
## [1] &quot;Completed runs = 5&quot;</code></pre>
<pre><code>## Class &#39;cpt&#39; : Changepoint Object
##        ~~   : S4 class containing 14 slots with names
##               cpts.full pen.value.full data.set cpttype method test.stat pen.type pen.value minseglen cpts ncpts.max param.est date version 
## 
## Created on  : Mon Apr 23 00:37:43 2018 
## 
## summary(.)  :
## ----------
## Created Using changepoint version 2.2.2 
## Changepoint type      : Change in mean 
## Method of analysis    : PELT 
## Test Statistic  : Normal 
## Type of penalty       : CROPS with value, 1 25 
## Minimum Segment Length : 1 
## Maximum no. of cpts   : Inf 
## Changepoint Locations :  
## Range of segmentations:
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]
## [1,]    1    2    3    4    6    7    8    9   10    11    12    13    14
## [2,]    1    2    3    4    6    7    8    9   10    11    12    13    14
## [3,]    1    2    3    4    6    7    8    9   10    11    12    13    14
## [4,]    1    2    3    4    6    7    8    9   10    11    12    13    14
##      [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24]
## [1,]    15    16    17    18    19    20    21    22    23    24    25
## [2,]    15    16    17    18    19    20    21    22    23    24    25
## [3,]    15    16    17    18    19    20    21    22    23    24    25
## [4,]    15    16    17    18    19    20    21    22    23    24    25
##      [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35]
## [1,]    26    27    28    29    30    31    32    33    34    35    36
## [2,]    26    27    28    29    30    31    32    33    34    35    36
## [3,]    26    27    28    29    30    31    32    33    34    35    36
## [4,]    26    27    28    29    30    31    32    33    34    35    36
##      [,36] [,37] [,38] [,39] [,40] [,41] [,42] [,43] [,44] [,45] [,46]
## [1,]    37    38    39    40    41    42    43    44    45    46    47
## [2,]    37    38    39    40    41    42    43    44    45    46    47
## [3,]    37    38    39    40    41    42    43    44    45    46    47
## [4,]    37    38    39    40    41    42    43    44    45    46    47
##      [,47] [,48] [,49] [,50] [,51] [,52] [,53] [,54] [,55] [,56] [,57]
## [1,]    48    49    50    51    52    53    54    55    56    57    58
## [2,]    48    49    50    51    52    54    55    56    57    58    59
## [3,]    48    49    50    51    52    54    55    56    57    58    59
## [4,]    48    49    50    51    52    54    55    56    57    58    59
##      [,58] [,59] [,60] [,61] [,62] [,63] [,64] [,65] [,66] [,67] [,68]
## [1,]    59    60    61    62    63    64    65    66    67    68    69
## [2,]    60    61    62    63    64    65    66    67    68    69    70
## [3,]    60    61    62    63    64    65    66    67    68    69    70
## [4,]    60    61    62    63    64    65    66    67    68    69    70
##      [,69] [,70] [,71] [,72] [,73] [,74] [,75] [,76] [,77] [,78] [,79]
## [1,]    70    71    72    73    74    75    76    77    78    79    80
## [2,]    71    72    73    74    75    76    77    78    79    80    81
## [3,]    71    72    73    74    75    76    77    78    79    80    81
## [4,]    71    72    73    74    75    76    77    78    79    80    82
##      [,80] [,81] [,82] [,83] [,84] [,85] [,86] [,87] [,88] [,89] [,90]
## [1,]    81    82    83    84    85    86    87    88    89    90    91
## [2,]    82    83    84    85    86    87    88    89    90    91    92
## [3,]    82    83    84    85    86    87    88    89    90    91    92
## [4,]    83    84    85    86    87    88    89    90    91    93    94
##      [,91] [,92] [,93] [,94] [,95] [,96] [,97] [,98]
## [1,]    92    93    94    95    96    97    98    99
## [2,]    93    94    95    96    97    98    99    NA
## [3,]    93    94    95    96    97    99    NA    NA
## [4,]    95    96    97    99    NA    NA    NA    NA
## 
##  For penalty values: 1 2 8 12.5</code></pre>
<p>Too many changepoints detected (same when settings changed to “SegNeigh” or “BinSeg” method)</p>
</div>
<div id="bcp" class="section level4">
<h4>bcp</h4>
<pre class="r"><code>x &lt;- Nile
bcp_x &lt;- bcp(x, return.mcmc = TRUE)
plot(bcp_x)</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-6-1.png" width="672" /> Let’s see at which time step the posterior probability of a change (?) is above 70%:</p>
<pre class="r"><code>bcp_sum &lt;- as.data.frame(summary(bcp_x))</code></pre>
<pre><code>## 
## Bayesian Change Point (bcp) summary:
## 
## 
## Probability of a change in mean and posterior means:
## 
##     Probability     X1
## 1         0.024 1087.4
## 2         0.012 1087.1
## 3         0.010 1086.6
## 4         0.012 1086.8
## 5         0.014 1086.7
## 6         0.014 1086.1
## 7         0.016 1084.0
## 8         0.020 1087.3
## 9         0.040 1090.0
## 10        0.048 1084.0
## 11        0.028 1078.3
## 12        0.010 1075.8
## 13        0.020 1075.8
## 14        0.016 1075.1
## 15        0.008 1074.2
## 16        0.020 1073.8
## 17        0.038 1074.6
## 18        0.036 1069.8
## 19        0.084 1074.3
## 20        0.036 1086.3
## 21        0.060 1090.1
## 22        0.024 1097.6
## 23        0.026 1099.7
## 24        0.016 1101.6
## 25        0.010 1102.4
## 26        0.074 1102.2
## 27        0.014 1086.3
## 28        0.886 1084.6
## 29        0.046  858.2
## 30        0.024  851.4
## 31        0.018  848.9
## 32        0.020  847.7
## 33        0.008  848.7
## 34        0.010  848.9
## 35        0.020  848.7
## 36        0.012  850.1
## 37        0.044  849.8
## 38        0.016  855.6
## 39        0.030  856.9
## 40        0.030  855.5
## 41        0.072  849.9
## 42        0.034  836.1
## 43        0.054  830.1
## 44        0.026  840.3
## 45        0.082  843.1
## 46        0.028  863.0
## 47        0.046  861.6
## 48        0.024  852.2
## 49        0.018  850.7
## 50        0.012  850.0
## 51        0.014  850.0
## 52        0.010  850.2
## 53        0.016  850.2
## 54        0.008  850.1
## 55        0.008  850.0
## 56        0.018  850.1
## 57        0.014  850.4
## 58        0.024  850.8
## 59        0.012  851.7
## 60        0.014  851.7
## 61        0.012  852.1
## 62        0.016  852.7
## 63        0.024  853.4
## 64        0.014  854.5
## 65        0.016  855.0
## 66        0.024  854.1
## 67        0.016  853.1
## 68        0.018  853.0
## 69        0.020  851.6
## 70        0.018  849.9
## 71        0.022  849.8
## 72        0.022  851.0
## 73        0.020  852.1
## 74        0.018  852.9
## 75        0.032  854.3
## 76        0.016  856.6
## 77        0.016  857.2
## 78        0.020  857.8
## 79        0.020  858.1
## 80        0.022  858.6
## 81        0.016  859.1
## 82        0.036  860.0
## 83        0.060  862.6
## 84        0.016  868.1
## 85        0.020  868.6
## 86        0.008  869.3
## 87        0.012  868.8
## 88        0.014  869.5
## 89        0.018  870.0
## 90        0.018  870.3
## 91        0.012  871.0
## 92        0.006  871.6
## 93        0.024  871.9
## 94        0.044  874.4
## 95        0.068  867.6
## 96        0.034  857.5
## 97        0.054  854.5
## 98        0.022  845.9
## 99        0.014  843.3
## 100          NA  842.1</code></pre>
<pre class="r"><code>bcp_sum$id &lt;- 1:length(x)
(sel &lt;- bcp_sum[which(bcp_x$posterior.prob &gt; 0.7), ])</code></pre>
<pre><code>##    Probability       X1 id
## 28       0.886 1084.559 28</code></pre>
<pre class="r"><code>time(x)[sel$id] # Year</code></pre>
<pre><code>## [1] 1898</code></pre>
</div>
<div id="strucchange" class="section level4">
<h4>strucchange</h4>
<pre class="r"><code>ocus_nile &lt;- efp(Nile ~ 1, type = &quot;OLS-CUSUM&quot;)
op &lt;- par(mfrow = c(1,2))
plot(ocus_nile)
plot(ocus_nile, alpha = 0.01, alt.boundary = TRUE)</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre class="r"><code>par(op)</code></pre>
<p>Process has a peak around 1900 which exceeds the boundaries and hence indicates a clear structural shift at that time.</p>
<p>Calculate corresponding test statistic for structural change:</p>
<pre class="r"><code>sctest(ocus_nile)</code></pre>
<pre><code>## 
##  OLS-based CUSUM test
## 
## data:  ocus_nile
## S0 = 2.9518, p-value = 5.409e-08</code></pre>
<p>F test:</p>
<pre class="r"><code>fs_nile &lt;- Fstats(Nile ~ 1)
plot(fs_nile)</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>Same conclusion from tests based on F statistics.</p>
<p>Estimate breakpoint from <code>breakpoints()</code> function:</p>
<pre class="r"><code>bp_nile &lt;- breakpoints(Nile ~ 1)
bp_nile</code></pre>
<pre><code>## 
##   Optimal 2-segment partition: 
## 
## Call:
## breakpoints.formula(formula = Nile ~ 1)
## 
## Breakpoints at observation number:
## 28 
## 
## Corresponding to breakdates:
## 1898</code></pre>
<pre class="r"><code>summary(bp_nile)</code></pre>
<pre><code>## 
##   Optimal (m+1)-segment partition: 
## 
## Call:
## breakpoints.formula(formula = Nile ~ 1)
## 
## Breakpoints at observation number:
##                       
## m = 1      28         
## m = 2      28       83
## m = 3      28    68 83
## m = 4      28 45 68 83
## m = 5   15 30 45 68 83
## 
## Corresponding to breakdates:
##                                 
## m = 1        1898               
## m = 2        1898           1953
## m = 3        1898      1938 1953
## m = 4        1898 1915 1938 1953
## m = 5   1885 1900 1915 1938 1953
## 
## Fit:
##                                                    
## m   0       1       2       3       4       5      
## RSS 2835157 1597457 1552924 1538097 1507888 1659994
## BIC    1318    1270    1276    1285    1292    1311</code></pre>
<p>To check for more breaks the <code>breakpoint()</code> function can be also applied to breakpoints object</p>
<pre class="r"><code>breakpoints(bp_nile, breaks = 2)</code></pre>
<pre><code>## 
##   Optimal 3-segment partition: 
## 
## Call:
## breakpoints.breakpointsfull(obj = bp_nile, breaks = 2)
## 
## Breakpoints at observation number:
## 28 83 
## 
## Corresponding to breakdates:
## 1898 1953</code></pre>
<pre class="r"><code>breakpoints(bp_nile, breaks = 3)</code></pre>
<pre><code>## 
##   Optimal 4-segment partition: 
## 
## Call:
## breakpoints.breakpointsfull(obj = bp_nile, breaks = 3)
## 
## Breakpoints at observation number:
## 28 68 83 
## 
## Corresponding to breakdates:
## 1898 1938 1953</code></pre>
<p>BIC estimates for different numbers of breakpoint</p>
<pre class="r"><code>plot(bp_nile)</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-13-1.png" width="672" /> The BIC also chooses one breakpoint.</p>
<p>To get the optimal number numerically, here is a solution:</p>
<pre class="r"><code># get best model
opt_bpts &lt;- function(x) {
  #x = bpts_sum$RSS[&quot;BIC&quot;,]
  n &lt;- length(x)
  lowest &lt;- vector(&quot;logical&quot;, length = n-1)
  lowest[1] &lt;- FALSE
  for (i in 2:n) {
    lowest[i] &lt;- x[i] &lt; x[i-1] &amp; x[i] &lt; x[i+1]
  }
  out &lt;- as.integer(names(x)[lowest])
  return(out)
}
bpts_sum &lt;- summary(bp_nile)
opt_brks &lt;- opt_bpts(bpts_sum$RSS[&quot;BIC&quot;,])
opt_brks</code></pre>
<pre><code>## [1] 1</code></pre>
<p>To visualize the breakpoints in the time series plot with confidence intervals:</p>
<pre class="r"><code>ci_nile &lt;- confint(bp_nile, breaks = opt_brks)
plot(Nile)
lines(ci_nile)</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>Compare the null model with the model with 1 breakpoint:</p>
<pre class="r"><code>fm0 &lt;- lm(Nile ~ 1)
coef(fm0)</code></pre>
<pre><code>## (Intercept) 
##      919.35</code></pre>
<pre class="r"><code>nile_fac &lt;- breakfactor(bp_nile, breaks = 1)
fm1 &lt;- lm(Nile ~ nile_fac - 1)
coef(fm1)</code></pre>
<pre><code>## nile_facsegment1 nile_facsegment2 
##        1097.7500         849.9722</code></pre>
<pre class="r"><code>plot(Nile)
lines(ts(fitted(fm0), start = 1871), col = 3)
lines(ts(fitted(fm1), start = 1871), col = 4)
lines(bp_nile)</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
<div id="segmented" class="section level4">
<h4>segmented</h4>
<p>With this method, the number of breakpoints have to be set as starting point apriori:</p>
<pre class="r"><code>Nile_df &lt;- data.frame(Nile = as.numeric(Nile), Year = 1871:1970)
seg_nile &lt;- segmented(lm(Nile ~ 1, data = Nile_df), ~ Year, 
  psi = list(Year = c(1900))) # using 1900 as starting value
summary(seg_nile)</code></pre>
<pre><code>## 
##  ***Regression Model with Segmented Relationship(s)***
## 
## Call: 
## segmented.lm(obj = lm(Nile ~ 1, data = Nile_df), seg.Z = ~Year, 
##     psi = list(Year = c(1900)))
## 
## Estimated Break-Point(s):
##      Est.   St.Err 
## 1876.245   25.454 
## 
## Meaningful coefficients of the linear terms:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 1040.412     61.866  16.817   &lt;2e-16 ***
## U1.Year       -2.725      0.576  -4.731       NA    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 151.5 on 97 degrees of freedom
## Multiple R-Squared: 0.2143,  Adjusted R-squared: 0.1981 
## 
## Convergence attained in 1 iterations with relative change -0.2351176</code></pre>
<pre class="r"><code>slope(seg_nile)</code></pre>
<pre><code>## $Year
##           Est. St.Err. t value CI(95%).l CI(95%).u
## slope1  0.0000      NA      NA        NA        NA
## slope2 -2.7254 0.57604 -4.7313   -3.8687   -1.5821</code></pre>
<pre class="r"><code>plot(Nile ~ Year, data = Nile_df, type = &quot;l&quot;)
plot(seg_nile, add=T)
lines(seg_nile,col=&#39;red&#39;)</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Segmented does not detect any change. It is not devised for this kind of step changes.</p>
</div>
<div id="tree" class="section level4">
<h4>tree</h4>
<pre class="r"><code>Nile_df &lt;- data.frame(Nile = as.numeric(Nile), Year = 1871:1970)
tree_nile &lt;- tree(Nile ~ Year, data = Nile_df)
summary(tree_nile)</code></pre>
<pre><code>## 
## Regression tree:
## tree(formula = Nile ~ Year, data = Nile_df)
## Number of terminal nodes:  6 
## Residual mean deviance:  13750 = 1293000 / 94 
## Distribution of residuals:
##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
## -380.100  -62.160   -3.645    0.000   54.840  283.900</code></pre>
<pre class="r"><code>plot(tree_nile)
text(tree_nile, pretty = 0)</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>
</div>
<div id="artificial-data" class="section level3">
<h3>Artificial data</h3>
<pre class="r"><code>set.seed(1)
# Normal distributed data with a single change in mean (at x = 25-26)
df &lt;- data.frame(
  x = 1:50,
  z = c(rnorm(25,0,1), rnorm(25,5,1))
)
plot(df$x, df$z, type = &#39;l&#39;, xlab = &#39;&#39;, ylab = &#39;&#39;)
lines(x = 1:25, y = rep(0,25), col = &#39;red&#39;, lwd = 3)
lines(x=26:50, y = rep(5,25), col = &#39;red&#39;, lwd = 3)</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<div id="changepoint-1" class="section level4">
<h4>changepoint</h4>
<p>Testing for 1 changepoint</p>
<pre><code>## Created Using changepoint version 2.2.2 
## Changepoint type      : Change in mean 
## Method of analysis    : AMOC 
## Test Statistic  : Normal 
## Type of penalty       : MBIC with value, 11.73607 
## Minimum Segment Length : 1 
## Maximum no. of cpts   : 1 
## Changepoint Locations : 25</code></pre>
<p>Testing for several using PELT method and AIC penalty:</p>
<pre><code>## Class &#39;cpt&#39; : Changepoint Object
##        ~~   : S4 class containing 12 slots with names
##               cpttype date version data.set method test.stat pen.type pen.value minseglen cpts ncpts.max param.est 
## 
## Created on  : Mon Apr 23 00:37:43 2018 
## 
## summary(.)  :
## ----------
## Created Using changepoint version 2.2.2 
## Changepoint type      : Change in mean 
## Method of analysis    : PELT 
## Test Statistic  : Normal 
## Type of penalty       : AIC with value, 4 
## Minimum Segment Length : 1 
## Maximum no. of cpts   : Inf 
## Changepoint Locations : 25</code></pre>
<p>Also just 1 changepoint detected at x = 25.</p>
<p>Testing for several using PELT method and CROPS penalty:</p>
<pre><code>## [1] &quot;Maximum number of runs of algorithm = 13&quot;
## [1] &quot;Completed runs = 2&quot;
## [1] &quot;Completed runs = 3&quot;
## [1] &quot;Completed runs = 5&quot;
## [1] &quot;Completed runs = 9&quot;
## [1] &quot;Completed runs = 11&quot;
## [1] &quot;Completed runs = 12&quot;</code></pre>
<pre><code>## Created Using changepoint version 2.2.2 
## Changepoint type      : Change in mean 
## Method of analysis    : PELT 
## Test Statistic  : Normal 
## Type of penalty       : CROPS with value, 1 25 
## Minimum Segment Length : 1 
## Maximum no. of cpts   : Inf 
## Changepoint Locations :  
## Number of segmentations recorded: 7  with between  1  and  12 changepoints.
##  Penalty value ranges from: 1  to  3.023723</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-23-1.png" width="672" /><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-23-2.png" width="672" /> In the following order strong changepoints detected:</p>
<pre class="r"><code>cpts_ord(cpts.full(cpt2))[1:5]</code></pre>
<pre><code>## [1] 25 13 14 23 24</code></pre>
<p>5 changepoints detected.</p>
</div>
<div id="bcp-1" class="section level4">
<h4>bcp</h4>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<pre><code>##    Probability       X1 id
## 25           1 0.176899 25</code></pre>
</div>
<div id="strucchange-1" class="section level4">
<h4>strucchange</h4>
<p>When looking at changes in the mean</p>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<pre><code>## 
##  OLS-based CUSUM test
## 
## data:  ocus_mod
## S0 = 3.3164, p-value = 5.593e-10</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-27-2.png" width="672" /></p>
<pre><code>## 
##   Optimal 2-segment partition: 
## 
## Call:
## breakpoints.formula(formula = z ~ 1, data = df)
## 
## Breakpoints at observation number:
## 25 
## 
## Corresponding to breakdates:
## 0.5</code></pre>
<pre><code>## 
##   Optimal (m+1)-segment partition: 
## 
## Call:
## breakpoints.formula(formula = z ~ 1, data = df)
## 
## Breakpoints at observation number:
##                         
## m = 1           25      
## m = 2           25 38   
## m = 3     14    25 38   
## m = 4   7 14    25 38   
## m = 5   7 14    25 36 43
## m = 6   7 14 21 28 36 43
## 
## Corresponding to breakdates:
##                                      
## m = 1                  0.5           
## m = 2                  0.5  0.76     
## m = 3        0.28      0.5  0.76     
## m = 4   0.14 0.28      0.5  0.76     
## m = 5   0.14 0.28      0.5  0.72 0.86
## m = 6   0.14 0.28 0.42 0.56 0.72 0.86
## 
## Fit:
##                                                     
## m   0      1      2      3      4      5      6     
## RSS 329.32  33.64  32.36  31.73  31.73  32.11  65.84
## BIC 243.97 137.72 143.62 150.46 158.27 166.70 210.42</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-27-3.png" width="672" /></p>
<p>To get the optimal number numerically, here is a solution:</p>
<pre class="r"><code>bpts_sum &lt;- summary(bpts)
opt_brks &lt;- opt_bpts(bpts_sum$RSS[&quot;BIC&quot;,])
opt_brks</code></pre>
<pre><code>## [1] 1</code></pre>
<p>All indicate 1 breakpoint in the middle:</p>
<pre><code>## [1] 25</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
</div>
<div id="segmented-1" class="section level4">
<h4>segmented</h4>
<pre><code>## 
##  ***Regression Model with Segmented Relationship(s)***
## 
## Call: 
## segmented.lm(obj = lin_mod, seg.Z = ~x, psi = 20)
## 
## Estimated Break-Point(s):
##    Est. St.Err 
## 13.282  5.023 
## 
## Meaningful coefficients of the linear terms:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept) 0.103317   0.813919   0.127    0.900
## x           0.002849   0.102544   0.028    0.978
## U1.x        0.175041   0.104733   1.671       NA
## 
## Residual standard error: 1.383 on 46 degrees of freedom
## Multiple R-Squared: 0.7327,  Adjusted R-squared: 0.7152 
## 
## Convergence attained in 14 iterations with relative change -0.002120593</code></pre>
<pre><code>## $x
##             Est.  St.Err. t value CI(95%).l CI(95%).u
## slope1 0.0028487 0.102540 0.02778  -0.20356   0.20926
## slope2 0.1778900 0.021301 8.35130   0.13501   0.22077</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
</div>
<div id="tree-1" class="section level4">
<h4>tree</h4>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="changes-in-mean" class="section level2">
<h2>3 changes in mean</h2>
<pre class="r"><code>set.seed(2)
# Normal distributed data with 3 change in mean (at x = 25-11, 25-26, 45-46)
df &lt;- data.frame(
  x = 1:50,
  z=c(rnorm(10, 1, sd = 0.5), rnorm(15, 0, sd = 0.5),
    rnorm(20, 2, sd = 0.5), rnorm(5, 0.5 , sd = 0.5))
)
plot(df$x, df$z, type = &#39;l&#39;, xlab = &#39;&#39;, ylab = &#39;&#39;)
lines(x = 1:10, y = rep(1,10), col = &#39;red&#39;, lwd = 3)
lines(x = 11:25, y = rep(0,15), col = &#39;red&#39;, lwd = 3)
lines(x = 26:45, y = rep(2,20), col = &#39;red&#39;, lwd = 3)
lines(x = 46:50, y = rep(0.5,5), col = &#39;red&#39;, lwd = 3)</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<div id="changepoint-2" class="section level4">
<h4>changepoint</h4>
<p>Testing for 1 changepoint</p>
<pre><code>## Created Using changepoint version 2.2.2 
## Changepoint type      : Change in mean 
## Method of analysis    : AMOC 
## Test Statistic  : Normal 
## Type of penalty       : MBIC with value, 11.73607 
## Minimum Segment Length : 1 
## Maximum no. of cpts   : 1 
## Changepoint Locations :</code></pre>
<p>Testing for several using PELT method and AIC penalty:</p>
<pre><code>## Class &#39;cpt&#39; : Changepoint Object
##        ~~   : S4 class containing 12 slots with names
##               cpttype date version data.set method test.stat pen.type pen.value minseglen cpts ncpts.max param.est 
## 
## Created on  : Mon Apr 23 00:37:43 2018 
## 
## summary(.)  :
## ----------
## Created Using changepoint version 2.2.2 
## Changepoint type      : Change in mean 
## Method of analysis    : PELT 
## Test Statistic  : Normal 
## Type of penalty       : AIC with value, 4 
## Minimum Segment Length : 1 
## Maximum no. of cpts   : Inf 
## Changepoint Locations : 10 26 46</code></pre>
<p>Testing for several using PELT method and CROP type:</p>
<pre><code>## [1] &quot;Maximum number of runs of algorithm = 9&quot;
## [1] &quot;Completed runs = 2&quot;
## [1] &quot;Completed runs = 3&quot;
## [1] &quot;Completed runs = 5&quot;
## [1] &quot;Completed runs = 8&quot;</code></pre>
<pre><code>## Created Using changepoint version 2.2.2 
## Changepoint type      : Change in mean 
## Method of analysis    : PELT 
## Test Statistic  : Normal 
## Type of penalty       : CROPS with value, 1 25 
## Minimum Segment Length : 1 
## Maximum no. of cpts   : Inf 
## Changepoint Locations :  
## Number of segmentations recorded: 7  with between  0  and  7 changepoints.
##  Penalty value ranges from: 1  to  14.06746</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-36-1.png" width="672" /><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-36-2.png" width="672" /> In the following order strong changepoints detected:</p>
<pre class="r"><code>cpts_ord(cpts.full(cpt2))</code></pre>
<pre><code>## [1] 26 46 10 15 16 33 43</code></pre>
<p>3 Changepoints detected</p>
</div>
<div id="bcp-2" class="section level4">
<h4>bcp</h4>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<pre><code>##    Probability        X1 id
## 26       0.868 0.6111902 26</code></pre>
</div>
<div id="strucchange-2" class="section level4">
<h4>strucchange</h4>
<p>When looking at changes in the mean</p>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<pre><code>## 
##  OLS-based CUSUM test
## 
## data:  ocus_mod
## S0 = 2.0704, p-value = 0.0003783</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-40-2.png" width="672" /></p>
<pre><code>## 
##   Optimal 4-segment partition: 
## 
## Call:
## breakpoints.formula(formula = z ~ 1, data = df)
## 
## Breakpoints at observation number:
## 10 26 34 
## 
## Corresponding to breakdates:
## 0.2 0.52 0.68</code></pre>
<pre><code>## 
##   Optimal (m+1)-segment partition: 
## 
## Call:
## breakpoints.formula(formula = z ~ 1, data = df)
## 
## Breakpoints at observation number:
##                          
## m = 1            26      
## m = 2   10       26      
## m = 3   10       26 34   
## m = 4   10       26 33 41
## m = 5   10 18    26 33 41
## m = 6   8  15 22 29 36 43
## 
## Corresponding to breakdates:
##                                      
## m = 1                  0.52          
## m = 2   0.2            0.52          
## m = 3   0.2            0.52 0.68     
## m = 4   0.2            0.52 0.66 0.82
## m = 5   0.2  0.36      0.52 0.66 0.82
## m = 6   0.16 0.3  0.44 0.58 0.72 0.86
## 
## Fit:
##                                                     
## m   0      1      2      3      4      5      6     
## RSS  40.14  26.07  21.49  18.01  17.08  16.30  22.59
## BIC 138.73 124.98 123.16 122.13 127.31 132.79 156.93</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-40-3.png" width="672" /></p>
<p>breakpoint anaylsis suggest 3 breakpoints, Fstats only 1 (in the middle) and the efp() function 2 (1 middle and 1 at end). BIC indicates also rather 3 breakpoints.</p>
<p>Get the optimal number numerically:</p>
<pre class="r"><code>bpts_sum &lt;- summary(bpts)
opt_brks &lt;- opt_bpts(bpts_sum$RSS[&quot;BIC&quot;,])
opt_brks</code></pre>
<pre><code>## [1] 3</code></pre>
<pre><code>## [1] 10 26 34</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
</div>
<div id="segmented-2" class="section level4">
<h4>segmented</h4>
<pre><code>## 
##  ***Regression Model with Segmented Relationship(s)***
## 
## Call: 
## segmented.lm(obj = lin_mod, seg.Z = ~x, psi = 20)
## 
## Estimated Break-Point(s):
##    Est. St.Err 
## 44.990  1.304 
## 
## Meaningful coefficients of the linear terms:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.334255   0.237984   1.405  0.16688    
## x            0.034959   0.009211   3.795  0.00043 ***
## U1.x        -0.468688   0.185701  -2.524       NA    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.7759 on 46 degrees of freedom
## Multiple R-Squared: 0.3101,  Adjusted R-squared: 0.2651 
## 
## Convergence attained in 2 iterations with relative change 0</code></pre>
<pre><code>## $x
##             Est.   St.Err. t value CI(95%).l CI(95%).u
## slope1  0.034959 0.0092113  3.7953  0.016418  0.053501
## slope2 -0.433730 0.1854700 -2.3385 -0.807060 -0.060393</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
</div>
<div id="tree-2" class="section level4">
<h4>tree</h4>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
</div>
</div>
<div id="break-in-relationship" class="section level2">
<h2>1 break in relationship</h2>
<pre class="r"><code>set.seed(3)
z &lt;- numeric(20)
## Create first segment
z[1:10] &lt;- 20:11 + rnorm(10, 0, 1.5)
## Create second segment
z[11:20] &lt;- seq(11, 15, len=10) + rnorm(10, 0, 1.5)
df &lt;- data.frame(x = 1:20, z = z)

plot(df$x, df$z, type=&#39;l&#39;,xlab=&#39;&#39;,ylab=&#39;&#39;)
lines(x = 1:10,y = 20:11, lwd = 3, col = &#39;red&#39;)
lines(x = 11:20, y = seq(11, 15, len=10), lwd = 3, col = &#39;red&#39;)</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<div id="changepoint-3" class="section level4">
<h4>changepoint</h4>
<p>Testing for 1 changepoint in mean</p>
<pre><code>## Created Using changepoint version 2.2.2 
## Changepoint type      : Change in mean 
## Method of analysis    : AMOC 
## Test Statistic  : Normal 
## Type of penalty       : MBIC with value, 8.987197 
## Minimum Segment Length : 1 
## Maximum no. of cpts   : 1 
## Changepoint Locations : 6</code></pre>
<p>Testing for several using PELT method and AIC penalty:</p>
<pre><code>## Class &#39;cpt&#39; : Changepoint Object
##        ~~   : S4 class containing 12 slots with names
##               cpttype date version data.set method test.stat pen.type pen.value minseglen cpts ncpts.max param.est 
## 
## Created on  : Mon Apr 23 00:37:43 2018 
## 
## summary(.)  :
## ----------
## Created Using changepoint version 2.2.2 
## Changepoint type      : Change in mean 
## Method of analysis    : PELT 
## Test Statistic  : Normal 
## Type of penalty       : AIC with value, 4 
## Minimum Segment Length : 1 
## Maximum no. of cpts   : Inf 
## Changepoint Locations : 3 8 13 18</code></pre>
<p>Testing for several using PELT method and CROPS penalty:</p>
<pre><code>## [1] &quot;Maximum number of runs of algorithm = 8&quot;
## [1] &quot;Completed runs = 2&quot;
## [1] &quot;Completed runs = 3&quot;
## [1] &quot;Completed runs = 5&quot;
## [1] &quot;Completed runs = 6&quot;
## [1] &quot;Completed runs = 7&quot;</code></pre>
<pre><code>## Created Using changepoint version 2.2.2 
## Changepoint type      : Change in mean 
## Method of analysis    : PELT 
## Test Statistic  : Normal 
## Type of penalty       : CROPS with value, 1 25 
## Minimum Segment Length : 1 
## Maximum no. of cpts   : Inf 
## Changepoint Locations :  
## Number of segmentations recorded: 6  with between  1  and  7 changepoints.
##  Penalty value ranges from: 1  to  24.57129</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-49-1.png" width="672" /><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-49-2.png" width="672" /> In the following order strong changepoints detected:</p>
<pre class="r"><code>cpts_ord(cpts.full(cpt2))[1:3]</code></pre>
<pre><code>## [1]  6  8 18</code></pre>
<p>3 strong changepoints detected.</p>
</div>
<div id="bcp-3" class="section level4">
<h4>bcp</h4>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
<pre><code>##   Probability       X1 id
## 8       0.746 14.36749  8</code></pre>
</div>
<div id="strucchange-3" class="section level4">
<h4>strucchange</h4>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
<pre><code>## 
##  OLS-based CUSUM test
## 
## data:  ocus_mod
## S0 = 0.78922, p-value = 0.5618</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-53-2.png" width="672" /></p>
<pre><code>## 
##   Optimal 2-segment partition: 
## 
## Call:
## breakpoints.formula(formula = z ~ x, data = df)
## 
## Breakpoints at observation number:
## 10 
## 
## Corresponding to breakdates:
## 0.5</code></pre>
<pre><code>## 
##   Optimal (m+1)-segment partition: 
## 
## Call:
## breakpoints.formula(formula = z ~ x, data = df)
## 
## Breakpoints at observation number:
##                     
## m = 1       10      
## m = 2     8 12      
## m = 3     8    13 16
## m = 4   3 8    13 16
## m = 5   3 8 11 14 17
## 
## Corresponding to breakdates:
##                                
## m = 1            0.5           
## m = 2        0.4 0.6           
## m = 3        0.4      0.65 0.8 
## m = 4   0.15 0.4      0.65 0.8 
## m = 5   0.15 0.4 0.55 0.7  0.85
## 
## Fit:
##                                              
## m   0      1      2      3      4      5     
## RSS 110.17  19.51  16.97  13.91  11.11  10.24
## BIC  99.87  74.23  80.43  85.44  89.93  97.29</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-53-3.png" width="672" /></p>
<p>Get the optimal number numerically:</p>
<pre class="r"><code>bpts_sum &lt;- summary(bpts)
opt_brks &lt;- opt_bpts(bpts_sum$RSS[&quot;BIC&quot;,])
opt_brks</code></pre>
<pre><code>## [1] 1</code></pre>
<p>All indicate 1 breakpoint rather at the end:</p>
<pre><code>## [1] 10</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>
</div>
<div id="segmented-3" class="section level4">
<h4>segmented</h4>
<pre><code>## 
##  ***Regression Model with Segmented Relationship(s)***
## 
## Call: 
## segmented.lm(obj = lin_mod, seg.Z = ~x, psi = 10)
## 
## Estimated Break-Point(s):
##    Est. St.Err 
## 11.648  0.672 
## 
## Meaningful coefficients of the linear terms:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  20.0262     0.7280  27.510 6.69e-15 ***
## x            -0.8547     0.1073  -7.963 5.88e-07 ***
## U1.x          1.5052     0.1807   8.331       NA    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.126 on 16 degrees of freedom
## Multiple R-Squared: 0.8609,  Adjusted R-squared: 0.8348 
## 
## Convergence attained in 3 iterations with relative change 1.752145e-16</code></pre>
<pre><code>## $x
##            Est. St.Err. t value CI(95%).l CI(95%).u
## slope1 -0.85473 0.10733 -7.9635  -1.08230  -0.62720
## slope2  0.65043 0.14533  4.4756   0.34235   0.95851</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
</div>
<div id="tree-3" class="section level4">
<h4>tree</h4>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
</div>
</div>
<div id="cubic-decay-function" class="section level2">
<h2>Cubic decay function</h2>
<pre class="r"><code>set.seed(4)
x &lt;- 1:50
z_nonoise &lt;- (10000 + 0.05*x + 0.2*x^2 - 0.2*x^3)
z &lt;- z_nonoise + rnorm(50,1000,500)
df &lt;- data.frame(x = x, z = z)

plot(df$x, df$z, type = &#39;l&#39;, xlab = &#39;&#39;, ylab = &#39;&#39;)</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
<div id="changepoint-4" class="section level4">
<h4>changepoint</h4>
<p>Testing for 1 changepoint in mean</p>
<pre><code>## Created Using changepoint version 2.2.2 
## Changepoint type      : Change in mean 
## Method of analysis    : AMOC 
## Test Statistic  : Normal 
## Type of penalty       : MBIC with value, 11.73607 
## Minimum Segment Length : 1 
## Maximum no. of cpts   : 1 
## Changepoint Locations : 35</code></pre>
<p>Testing for several using PELT method and AIC penalty:</p>
<pre><code>## Class &#39;cpt&#39; : Changepoint Object
##        ~~   : S4 class containing 12 slots with names
##               cpttype date version data.set method test.stat pen.type pen.value minseglen cpts ncpts.max param.est 
## 
## Created on  : Mon Apr 23 00:37:43 2018 
## 
## summary(.)  :
## ----------
## Created Using changepoint version 2.2.2 
## Changepoint type      : Change in mean 
## Method of analysis    : PELT 
## Test Statistic  : Normal 
## Type of penalty       : AIC with value, 4 
## Minimum Segment Length : 1 
## Maximum no. of cpts   : Inf 
## Number of changepoints: 49</code></pre>
<p>Testing for several using PELT method and CROPS penalty:</p>
<pre><code>## [1] &quot;Maximum number of runs of algorithm = 2&quot;
## [1] &quot;Completed runs = 2&quot;</code></pre>
<pre><code>## Created Using changepoint version 2.2.2 
## Changepoint type      : Change in mean 
## Method of analysis    : PELT 
## Test Statistic  : Normal 
## Type of penalty       : CROPS with value, 1 25 
## Minimum Segment Length : 1 
## Maximum no. of cpts   : Inf 
## Changepoint Locations :  
## Range of segmentations:
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]
## [1,]    1    2    3    4    5    6    7    8    9    10    11    12    13
##      [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24]
## [1,]    14    15    16    17    18    19    20    21    22    23    24
##      [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35]
## [1,]    25    26    27    28    29    30    31    32    33    34    35
##      [,36] [,37] [,38] [,39] [,40] [,41] [,42] [,43] [,44] [,45] [,46]
## [1,]    36    37    38    39    40    41    42    43    44    45    46
##      [,47] [,48] [,49]
## [1,]    47    48    49
## 
##  For penalty values: 1</code></pre>
<p>Nothing detected.</p>
</div>
<div id="bcp-4" class="section level4">
<h4>bcp</h4>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
<pre><code>##    Probability        X1 id
## 32       0.784  5591.184 32
## 43       0.902 -3204.395 43</code></pre>
</div>
<div id="strucchange-4" class="section level4">
<h4>strucchange</h4>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-65-1.png" width="672" /></p>
<pre><code>## 
##  OLS-based CUSUM test
## 
## data:  ocus_mod
## S0 = 1.5437, p-value = 0.01703</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-65-2.png" width="672" /></p>
<pre><code>## 
##   Optimal 4-segment partition: 
## 
## Call:
## breakpoints.formula(formula = z ~ x, data = df)
## 
## Breakpoints at observation number:
## 8 26 41 
## 
## Corresponding to breakdates:
## 0.16 0.52 0.82</code></pre>
<pre><code>## 
##   Optimal (m+1)-segment partition: 
## 
## Call:
## breakpoints.formula(formula = z ~ x, data = df)
## 
## Breakpoints at observation number:
##                         
## m = 1           29      
## m = 2        24       40
## m = 3   8       26    41
## m = 4   8    22 29    43
## m = 5   8    22 29 36 43
## m = 6   8 15 22 29 36 43
## 
## Corresponding to breakdates:
##                                     
## m = 1                 0.58          
## m = 2            0.48           0.8 
## m = 3   0.16          0.52      0.82
## m = 4   0.16     0.44 0.58      0.86
## m = 5   0.16     0.44 0.58 0.72 0.86
## m = 6   0.16 0.3 0.44 0.58 0.72 0.86
## 
## Fit:
##                                                                          
## m   0         1         2         3         4         5         6        
## RSS 4.406e+08 3.234e+07 1.195e+07 8.726e+06 7.056e+06 6.846e+06 6.645e+06
## BIC 9.532e+02 8.344e+02 7.963e+02 7.923e+02 7.934e+02 8.037e+02 8.139e+02</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-65-3.png" width="672" /></p>
<p>Get the optimal number numerically:</p>
<pre class="r"><code>bpts_sum &lt;- summary(bpts)
opt_brks &lt;- opt_bpts(bpts_sum$RSS[&quot;BIC&quot;,])
opt_brks</code></pre>
<pre><code>## [1] 3</code></pre>
<p>All indicate 1 breakpoint rather at the end:</p>
<pre><code>## [1]  8 26 41</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
</div>
<div id="segmented-4" class="section level4">
<h4>segmented</h4>
<pre><code>## 
##  ***Regression Model with Segmented Relationship(s)***
## 
## Call: 
## segmented.lm(obj = lin_mod, seg.Z = ~x, psi = 10)
## 
## Estimated Break-Point(s):
##    Est. St.Err 
## 29.676  0.580 
## 
## Meaningful coefficients of the linear terms:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 12288.57     319.63  38.447  &lt; 2e-16 ***
## x            -153.56      18.61  -8.252 1.26e-10 ***
## U1.x         -826.77      35.49 -23.298       NA    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 838.5 on 46 degrees of freedom
## Multiple R-Squared: 0.988,  Adjusted R-squared: 0.9872 
## 
## Convergence attained in 2 iterations with relative change 3.455907e-16</code></pre>
<pre><code>## $x
##           Est. St.Err.  t value CI(95%).l CI(95%).u
## slope1 -153.56  18.609  -8.2516   -191.02    -116.1
## slope2 -980.32  30.216 -32.4440  -1041.10    -919.5</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
</div>
<div id="tree-4" class="section level4">
<h4>tree</h4>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-71-1.png" width="672" /></p>
</div>
</div>
<div id="highly-non-linear-3-changes-in-regression" class="section level2">
<h2>Highly non-linear (3 changes in regression)</h2>
<pre class="r"><code>set.seed(5)
x &lt;- 1:50
z_nonoise &lt;- c(0.1*x[1:10], 1.5-0.2*(x[11:25]-11), 
  -1.5 + 0.2*(x[26:45]-26), rep(1,5))
z &lt;- z_nonoise + rnorm(50,0,0.2)
df &lt;- data.frame(x = x, z = z)

plot(df$x, df$z, type = &#39;l&#39;, xlab = &#39;&#39;, ylab = &#39;&#39;)
lines(x = 1:10,y = 0.1*x[1:10], lwd = 3, col = &#39;red&#39;)
lines(x = 11:25, y = 1.5-0.2*(x[11:25]-11), lwd = 3, col = &#39;red&#39;)
lines(x = 26:45, y = -1.5 + 0.2*(x[26:45]-26), lwd = 3, col = &#39;red&#39;)
lines(x = 46:50, y = rep(1,5), lwd = 3, col = &#39;red&#39;)</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
<div id="changepoint-5" class="section level4">
<h4>changepoint</h4>
<p>Testing for 1 changepoint in mean</p>
<pre><code>## Created Using changepoint version 2.2.2 
## Changepoint type      : Change in mean 
## Method of analysis    : AMOC 
## Test Statistic  : Normal 
## Type of penalty       : MBIC with value, 11.73607 
## Minimum Segment Length : 1 
## Maximum no. of cpts   : 1 
## Changepoint Locations :</code></pre>
<p>Nothing found with the AMOC method.</p>
<p>Testing for several using PELT method and AIC penalty:</p>
<pre><code>## Class &#39;cpt&#39; : Changepoint Object
##        ~~   : S4 class containing 12 slots with names
##               cpttype date version data.set method test.stat pen.type pen.value minseglen cpts ncpts.max param.est 
## 
## Created on  : Mon Apr 23 00:37:43 2018 
## 
## summary(.)  :
## ----------
## Created Using changepoint version 2.2.2 
## Changepoint type      : Change in mean 
## Method of analysis    : PELT 
## Test Statistic  : Normal 
## Type of penalty       : AIC with value, 4 
## Minimum Segment Length : 1 
## Maximum no. of cpts   : Inf 
## Changepoint Locations : 17 32</code></pre>
<p>Testing for several using PELT method and CROPS penalty:</p>
<pre><code>## [1] &quot;Maximum number of runs of algorithm = 8&quot;
## [1] &quot;Completed runs = 2&quot;
## [1] &quot;Completed runs = 3&quot;
## [1] &quot;Completed runs = 5&quot;
## [1] &quot;Completed runs = 7&quot;</code></pre>
<pre><code>## Created Using changepoint version 2.2.2 
## Changepoint type      : Change in mean 
## Method of analysis    : PELT 
## Test Statistic  : Normal 
## Type of penalty       : CROPS with value, 1 25 
## Minimum Segment Length : 1 
## Maximum no. of cpts   : Inf 
## Changepoint Locations :  
## Number of segmentations recorded: 7  with between  0  and  6 changepoints.
##  Penalty value ranges from: 1  to  14.97552</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-75-1.png" width="672" /><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-75-2.png" width="672" /> In the following order 2 strong changepoints detected:</p>
<pre class="r"><code>cpts_ord(cpts.full(cpt2))[1:2]</code></pre>
<pre><code>## [1] 39 17</code></pre>
</div>
<div id="bcp-5" class="section level4">
<h4>bcp</h4>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-78-1.png" width="672" /></p>
<pre><code>##    Probability        X1 id
## 39       0.718 0.6137687 39
## 45       0.942 2.0753858 45</code></pre>
</div>
<div id="strucchange-5" class="section level4">
<h4>strucchange</h4>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-79-1.png" width="672" /></p>
<pre><code>## 
##  OLS-based CUSUM test
## 
## data:  ocus_mod
## S0 = 1.3915, p-value = 0.04161</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-79-2.png" width="672" /></p>
<pre><code>## 
##   Optimal 4-segment partition: 
## 
## Call:
## breakpoints.formula(formula = z ~ x, data = df)
## 
## Breakpoints at observation number:
## 10 26 43 
## 
## Corresponding to breakdates:
## 0.2 0.52 0.86</code></pre>
<pre><code>## 
##   Optimal (m+1)-segment partition: 
## 
## Call:
## breakpoints.formula(formula = z ~ x, data = df)
## 
## Breakpoints at observation number:
##                          
## m = 1            31      
## m = 2         23       43
## m = 3   10       26    43
## m = 4   10    25    36 43
## m = 5   10 18 25    36 43
## m = 6   7  14 22 29 36 43
## 
## Corresponding to breakdates:
##                                      
## m = 1                  0.62          
## m = 2             0.46           0.86
## m = 3   0.2            0.52      0.86
## m = 4   0.2       0.5       0.72 0.86
## m = 5   0.2  0.36 0.5       0.72 0.86
## m = 6   0.14 0.28 0.44 0.58 0.72 0.86
## 
## Fit:
##                                                            
## m   0       1       2       3       4       5       6      
## RSS  36.889  14.781   8.544   2.724   2.330   2.079   3.047
## BIC 138.424 104.434  88.760  43.337  47.264  53.304  84.158</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-79-3.png" width="672" /> The pattern is less clear but the BIC suggest clearly 3 changepoints.</p>
<p>Get the optimal number numerically:</p>
<pre class="r"><code>bpts_sum &lt;- summary(bpts)
opt_brks &lt;- opt_bpts(bpts_sum$RSS[&quot;BIC&quot;,])
opt_brks</code></pre>
<pre><code>## [1] 3</code></pre>
<p>The breakpoints are located at x =…</p>
<pre><code>## [1] 10 26 43</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-82-1.png" width="672" /></p>
</div>
<div id="segmented-5" class="section level4">
<h4>segmented</h4>
<pre><code>## 
##  ***Regression Model with Segmented Relationship(s)***
## 
## Call: 
## segmented.lm(obj = lin_mod, seg.Z = ~x, psi = list(x = c(10, 
##     20, 40)))
## 
## Estimated Break-Point(s):
##           Est. St.Err
## psi1.x 11.019  0.703
## psi2.x 25.998  0.526
## psi3.x 43.972  0.515
## 
## Meaningful coefficients of the linear terms:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.10879    0.16986  -0.640    0.525    
## x            0.12495    0.02505   4.989  1.1e-05 ***
## U1.x        -0.29823    0.03050  -9.777       NA    
## U2.x         0.36098    0.02111  17.098       NA    
## U3.x        -0.43043    0.05106  -8.431       NA    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2627 on 42 degrees of freedom
## Multiple R-Squared: 0.9266,  Adjusted R-squared: 0.9144 
## 
## Convergence attained in 21 iterations with relative change -0.00365248</code></pre>
<pre><code>## $x
##            Est.  St.Err. t value CI(95%).l CI(95%).u
## slope1  0.12495 0.025045  4.9890  0.074406   0.17549
## slope2 -0.17328 0.017415 -9.9501 -0.208430  -0.13814
## slope3  0.18769 0.011934 15.7280  0.163610   0.21178
## slope4 -0.24274 0.049641 -4.8899 -0.342920  -0.14256</code></pre>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-83-1.png" width="672" /></p>
</div>
<div id="tree-5" class="section level4">
<h4>tree</h4>
<p><img src="/blog/2019-05-21-comparison-of-changepoint-detection-methods_files/figure-html/unnamed-chunk-84-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="conclusion" class="section level1">
<h1>Conclusion</h1>
<div id="changes-in-mean-1" class="section level2">
<h2>Changes in mean:</h2>
<p>All methods detected the true changepoints in the data EXCEPT for the <code>segmented</code> package!</p>
<ul>
<li><code>changepoint</code>:
<ul>
<li>disadvantage here is that one needs to specify <em>a priori</em> if 1 or multiple changes and</li>
<li>there are many parameters to set (in my examples, however, resulted in same changepoints)</li>
<li>when penalty = “CROPS”, one needs to visually inspect the optimal number of changepoints</li>
</ul></li>
<li><code>bcp</code>:
<ul>
<li>easy to use, not much to specify</li>
<li>no specification of changepoints to set <em>a priori</em></li>
</ul></li>
<li><code>strucchange</code>:
<ul>
<li>can cope with many model types, also for changes in means by specifying y ~ 1</li>
<li>provides confidence intervals of changepoints</li>
<li>several test statistics for checking for structural changes: <code>sctest()</code>, <code>Fstats()</code>, <code>breakpoints()</code>,<code>plot(breakpoints())</code></li>
<li>disav.: need to inspect visually number of optimal changepoints (with broken stick plot of BIC)</li>
<li>disav.: sum of the output is tuned to ts object, needs some recoding to adjust to ordinary dataframe</li>
</ul></li>
<li><code>segmented</code>: useless for changes in mean!</li>
<li><code>tree</code>:
<ul>
<li>disadv.: gets sometimes more breakpoints –&gt; how to choose the optimal one?</li>
<li>adv.: interpolates changepoints –&gt; identifies also continuous changepoints, which is maybe more suitable for continuous pressure variables</li>
</ul></li>
</ul>
</div>
<div id="changes-in-functional-curves-of-relatioships-between-y-and-x" class="section level2">
<h2>Changes in functional curves of relatioships between Y and X:</h2>
<p>All methods that identify changes in mean are not suitable for this type of question. Only <code>strucchange</code> and <code>segmented</code> gave reasonable results. I would favour <code>strucchange</code> over the other because</p>
<ul>
<li><code>strucchange</code>:
<ul>
<li>provides several test statistics</li>
<li>no <em>a priori</em> specification of changepoints, but: one needs to visuall inspect the BIC broken stick plot for optimal number of changepoints</li>
<li>provides confidence intervals around the location of the changepoints!</li>
<li>allows different type of model structures (but that also requires the correct specification –&gt; I checked; only the plot of the epf function and the sctest will differ; Fstats and breakpoint analysis remains the same)</li>
</ul></li>
<li><code>segmented</code>:
<ul>
<li>disadv.: requires starting values for the changepoints, hence, one needs to fix the number of changepoints <em>a priori</em></li>
<li>adv.: provides also confidence intervals around the location of the changepoints!</li>
<li>very siple model structure only allowed</li>
</ul></li>
</ul>
<!-- Footnotes: -->
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Cobb, G. W. (1978). The problem of the Nile: conditional solution to a change-point problem. Biometrika 65, 243–51. doi: 10.2307/2335202.<a href="#fnref1">↩</a></p></li>
</ol>
</div>

                        </div>
                        
                        
                        <div id="comments">
                            <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "www-marinedatascience-co" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
                        </div>
                        

                    </div>
                    

                    

                    

                    <div class="col-md-3">

                        

                        

<div class="panel panel-default sidebar-menu">

    <div class="panel-heading">
      <h3 class="panel-title">Search</h3>
    </div>

    <div class="panel-body">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" role="search">
            <div class="input-group">
                <input type="search" name="q" class="form-control" placeholder="Search">
                <input type="hidden" name="sitesearch" value="/">
                <span class="input-group-btn">
                    <button type="submit" class="btn btn-template-main"><i class="fa fa-search"></i></button>
                </span>
            </div>
        </form>
    </div>
</div>







<div class="panel panel-default sidebar-menu">

    <div class="panel-heading">
      <h3 class="panel-title">Categories</h3>
    </div>

    <div class="panel-body">
        <ul class="nav nav-pills nav-stacked">
            
            <li><a href="/categories/data-visualization">data-visualization (1)</a>
            </li>
            
            <li><a href="/categories/indicator">indicator (2)</a>
            </li>
            
            <li><a href="/categories/programming">programming (4)</a>
            </li>
            
            <li><a href="/categories/statistical-learning">statistical-learning (2)</a>
            </li>
            
        </ul>
    </div>
</div>








<div class="panel sidebar-menu">
    <div class="panel-heading">
      <h3 class="panel-title">Tags</h3>
    </div>

    <div class="panel-body">
        <ul class="tag-cloud">
            
            <li><a href="/tags/food-web"><i class="fa fa-tags"></i> food-web</a>
            </li>
            
            <li><a href="/tags/gam"><i class="fa fa-tags"></i> gam</a>
            </li>
            
            <li><a href="/tags/github"><i class="fa fa-tags"></i> github</a>
            </li>
            
            <li><a href="/tags/method-comparison"><i class="fa fa-tags"></i> method-comparison</a>
            </li>
            
            <li><a href="/tags/oceanography"><i class="fa fa-tags"></i> oceanography</a>
            </li>
            
            <li><a href="/tags/r-package"><i class="fa fa-tags"></i> r-package</a>
            </li>
            
            <li><a href="/tags/regime-shifts"><i class="fa fa-tags"></i> regime-shifts</a>
            </li>
            
            <li><a href="/tags/shiny"><i class="fa fa-tags"></i> shiny</a>
            </li>
            
        </ul>
    </div>
</div>






                        

                    </div>
                    

                    

                </div>
                

            </div>
            
        </div>
        

        <footer id="footer">
    <div class="container">

        
        <div class="col-md-4 col-sm-6">
            <h4>About me</h4>
            <img src="/img/profile_v1@2x.png" alt="profile" style="float:left;width:75px;height:75px;padding:5px;"/>

            I am a quantitative marine ecologist who loves combining nerdy programming, statistics, ecology and any activity in and around the oceans.

            <hr class="hidden-md hidden-lg hidden-sm">

        </div>
        
        

        <div class="col-md-4 hidden-sm" id="footer-posts">

             
            <h4>Recent posts</h4>

            <div class="blog-entries">
                
                <div class="item same-height-row clearfix">
                    <div class="image same-height-always">
                        <a href="/blog/2019/05/21/comparison-of-changepoint-detection-methods/">
                          
                            <img src="/img/placeholder.png" class="img-responsive" alt="Comparison of changepoint detection methods">
                          
                        </a>
                    </div>
                    <div class="name same-height-always">
                        <h5><a href="/blog/2019/05/21/comparison-of-changepoint-detection-methods/">Comparison of changepoint detection methods</a></h5>
                    </div>
                </div>
                
                <div class="item same-height-row clearfix">
                    <div class="image same-height-always">
                        <a href="/blog/2019/04/28/run-shiny-server-on-your-own-digitalocean-droplet-part-1/">
                          
                            <img src="/img/banners/shiny_droplet.png" class="img-responsive" alt="Run Shiny Server on your own DigitalOcean droplet - Part 1">
                          
                        </a>
                    </div>
                    <div class="name same-height-always">
                        <h5><a href="/blog/2019/04/28/run-shiny-server-on-your-own-digitalocean-droplet-part-1/">Run Shiny Server on your own DigitalOcean droplet - Part 1</a></h5>
                    </div>
                </div>
                
                <div class="item same-height-row clearfix">
                    <div class="image same-height-always">
                        <a href="/blog/2019/04/28/run-shiny-server-on-your-own-digitalocean-droplet-part-2/">
                          
                            <img src="/img/banners/shiny_droplet.png" class="img-responsive" alt="Run Shiny Server on your own DigitalOcean droplet - Part 2">
                          
                        </a>
                    </div>
                    <div class="name same-height-always">
                        <h5><a href="/blog/2019/04/28/run-shiny-server-on-your-own-digitalocean-droplet-part-2/">Run Shiny Server on your own DigitalOcean droplet - Part 2</a></h5>
                    </div>
                </div>
                
            </div>

            <hr class="hidden-md hidden-lg">
             

        </div>
        

        
        <div class="col-md-4 col-sm-6">

          <h4>Contact</h4>

            <strong><a href="https://www.biologie.uni-hamburg.de/en/einrichtungen/imf.html">Institute of Marine Ecosystem and Fishery Science</a></strong>
        <br>Center for Earth System Research and Sustainability
        <br>University of Hamburg
        <br><strong>Germany</strong><br>
      

            <a href="/contact" class="btn btn-small btn-template-main">Go to contact page</a>

            <hr class="hidden-md hidden-lg hidden-sm">

        </div>
        
        

    </div>
    
</footer>







<div id="copyright">
    <div class="container">
        <div class="col-md-12">
            
            <p class="pull-left">&copy; 2018 - This work is licensed under a <a rel='license' href='http://creativecommons.org/licenses/by-sa/4.0/'>Creative Commons Attribution-ShareAlike 4.0 International License </a></p>
            
            <p class="pull-right">
              <a href="/about/index.html#about-website">Legal Disclosure</a>
            </p>
        </div>
    </div>
</div>






    </div>
    

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-127654937-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

<script src="//code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/jquery.waypoints.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/Counter-Up/1.0/jquery.counterup.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-parallax/1.1.3/jquery-parallax.js"></script>
<script src="/js/hpneo.gmaps.js"></script>
<script src="/js/gmaps.init.js"></script>
<script src="/js/front.js"></script>


<script src="/js/owl.carousel.min.js"></script>





<script src="/js/highlight.pack.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/r.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>




<script src="/js/math-code.js"></script>
<script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>




<script id="dsq-count-scr" src="//www-marinedatascience-co.disqus.com/count.js" async></script>



<script>
  var shiftWindow = function() { scrollBy(0, -175) };
  if (location.hash) shiftWindow();
  window.addEventListener("hashchange", shiftWindow);
</script>


  </body>
</html>
