---
title: oce package for oceanographical data
author: Saskia
date: '2019-01-16'
slug: oce-package-for-oceanographical-data
categories:
  - data visualization
tags:
  - R package
  - oceanography
banner: "img/banners/oce_package.png"  
---



<p>In this post I will present the <a href="https://cran.r-project.org/package=oce">oce</a> package, which can be handy for marine data scientist working with <strong>oceanographical data</strong>. <em>oce</em> provides lots of functions to</p>
<ul>
<li>read oceanographic data,</li>
<li>process the data specific to the measuring instrument, and</li>
<li>visualize results following oceanographic conventions (using the base graphics).</li>
</ul>
<p>The key function for importing data into R is <code>?read.oce()</code>, which automatically recognizes the file type. If the recognition does not work, try the individual functions (e.g. <code>read.ctd()</code> for CTD files, <code>read.odf()</code> for ODF (Ocean Data Files) files, <code>read.netcdf()</code> for NetCDF files).</p>
<p>I won’t go into much detail on all the functions provided (for this see the <a href="https://cran.r-project.org/web/packages/oce/oce.pdf">reference manual</a> or <code>?oce</code> and then click on <strong>index</strong> at the bottom of the page). Instead, I will demonstrate you some plots you can create for specific datasets or purposes. The great advantage of this package is that you don’t need to wrangle your data into the typical data frame format for visualization and that it can handle many formats generated by typical oceanographical instruments!</p>
<p>The package also comes with few datasets included, e.g.</p>
<ul>
<li><code>ctd</code></li>
<li><code>wind</code></li>
<li><code>section</code> (a hydrographic section)</li>
<li><code>adp</code> (ADP (acoustic-doppler profiler) dataset)</li>
<li><code>echosounder</code> (a degraded subsample of measurements that were made with a Biosonics scientific echosounder, as part of the St Lawrence Internal Wave Experiment (SLEIWEX) )</li>
<li><code>landsat</code> (a sample from the landsat satellite dataset)</li>
<li><code>argo</code> (holds data from the argo float ARGO 6900388 in the North Atlantic; FYI: argo floats are robots that float at different depths in the sea collecting information)</li>
<li><code>lobo</code> (sample lobo dataset obtained in the Northwest Arm of Halifax by Satlantic; a lobo is a complete turn-key water quality monitoring system that addresses the need for routine, robust, and accurate measurements)</li>
<li><code>lisst</code> (data from a LISST instruments, which is an in-situ optical laser diffraction instrument to measure particle size and concentration of suspended sediments)</li>
</ul>
<p>Most other dataset have now been outsourced into the data package <a href="https://cran.r-project.org/package=ocedata">ocedata</a>.</p>
<div id="plot-ctd-data" class="section level2">
<h2>Plot CTD data</h2>
<p>Lets look first at the CTD data included (CTD stands for <strong>C</strong>onductivity, <strong>T</strong>emperature, and <strong>D</strong>epth) :</p>
<pre class="r"><code>library(oce)
data(ctd)
ctd</code></pre>
<pre><code>## ctd object, from file &#39;/Users/kelley/git/oce/create_data/ctd/ctd.cnv&#39;, has data as follows.
##    scan: 130, 131, ..., 309, 310 (length 181)
##    time: 129, 130, ..., 308, 309 (length 181)
##    pressure: 1.480, 1.671, ..., 43.903, 44.141 (length 181)
##    depth: 1.468, 1.657, ..., 43.542, 43.778 (length 181)
##    temperature: 14.225, 14.230, ..., 2.9190, 2.9194 (length 181)
##    salinity: 29.921, 29.921, ..., 31.395, 31.393 (length 181)
##    flag: 0, 0, ..., 0, 0 (length 181)</code></pre>
<pre class="r"><code>summary(ctd)</code></pre>
<pre><code>## CTD Summary
## -----------
## 
## * Instrument:          SBE 25 
## * Temp. serial no.:    1140
## * Cond. serial no.:    832
## * File:                &quot;/Users/kelley/git/oce/create_data/ctd/ctd.cnv&quot;
## * Original file:       c:\seasoft3\basin\bed0302.hex
## * Start time:          2003-10-15 11:38:38
## * Sample interval:     1 s
## * Cruise:              Halifax Harbour
## * Vessel:              Divcom3
## * Station:             Stn 2
## * Location:            44.684N  63.644W 
## * Data
## 
##                               Min.   Mean   Max.   Dim. OriginalName
##     scan                      130    220    310    181  scan        
##     pressure [dbar]           1.48   22.885 44.141 181  pr          
##     depth [m]                 1.468  22.698 43.778 181  depS        
##     temperature [°C, IPTS-68] 2.919  7.5063 14.237 181  t068        
##     salinity [PSS-78]         29.916 31.219 31.498 181  sal00       
##     flag                      0      0      0      181  flag        
## 
## * Processing Log
##     - 2017-09-09 17:00:27 UTC: `create &#39;ctd&#39; object`
##     - 2017-09-09 17:00:27 UTC: `read.ctd.sbe(file = file, processingLog = processingLog)`
##     - 2017-09-09 17:00:27 UTC: `oce.edit(x = ctd, item = &quot;startTime&quot;, value = ctd[[&quot;systemUploadTime&quot;]],     reason = &quot;startTime in file has Y2K error&quot;, person = &quot;Dan Kelley&quot;)`</code></pre>
<p>This dataset is a CTD profile measured at Halifax Harbour in 2003. The R object is obviously not in a data frame format but if you use an plotting function you don’t need to convert it as you will see next.</p>
<p>When loading the oce package, you can use the generic <code>plot()</code>function, which automatically recognizes the data type and applies the respective plotting method.</p>
<pre class="r"><code>plot(ctd)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-2"></span>
<img src="/blog/2019-01-16-oce-package-for-oceanographical-data_files/figure-html/unnamed-chunk-2-1.png" alt="Four panels produced for CTD data." width="672" />
<p class="caption">
Figure 1: Four panels produced for CTD data.
</p>
</div>
<p>The plot method for CTD data automatically generates several panels. If you want to plot only a subset, use the <code>which</code> argument:</p>
<pre class="r"><code>plot(ctd, which = 1)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-3"></span>
<img src="/blog/2019-01-16-oce-package-for-oceanographical-data_files/figure-html/unnamed-chunk-3-1.png" alt="Only the temperature and salinity profile." width="672" />
<p class="caption">
Figure 2: Only the temperature and salinity profile.
</p>
</div>
<p>In the <code>which</code> argument you can provide a scalar or vector of desired plots. In fact, all plots that the package can produce have a number from 1 to 33, but not all can be generated with the same type of data. If the input data type is CTD, plot number 1,2,3, and 5 are produced (see also <code>?plot,ctd-method</code>):</p>
<pre class="r"><code># same as plot(ctd):
plot(ctd, which = c(1,2,3,5))</code></pre>
<p>The following would not make much sense or give an error:</p>
<pre class="r"><code>plot(ctd, which=4)
plot(ctd, which=33)</code></pre>
</div>
<div id="plot-echosounder-objects" class="section level2">
<h2>Plot echosounder objects</h2>
<p>If you have data from an an echosounder in this format</p>
<pre class="r"><code>data(echosounder)
echosounder</code></pre>
<pre><code>## echosounder object, from file &#39;/data/archive/sleiwex/2008/fielddata/2008-07-01/Merlu/Biosonics/20080701_163942.dt4&#39;, has data as follows.
##    timeSlow: 2008-07-01 16:39:41, 2008-07-01 16:39:42, ..., 2008-07-01 16:42:49, 2008-07-01 16:42:50 (length 190)
##    latitudeSlow: 47.879, 47.879, ..., 47.882, 47.882 (length 190)
##    longitudeSlow: -69.724, -69.724, ..., -69.729, -69.729 (length 190)
##    depth: 39.648, 38.933, ..., 2.4417, 1.7262 (length 54)
##    time: 2008-07-01 16:39:41, 2008-07-01 16:39:41, ..., 2008-07-01 16:42:50, 2008-07-01 16:42:50 (length 389)
##    latitude: 47.879, 47.879, ..., 47.882, 47.882 (length 389)
##    longitude: -69.724, -69.724, ..., -69.729, -69.729 (length 389)
##    a, a 389x54 array with value 131.375 at [1,1] position</code></pre>
<pre class="r"><code>summary(echosounder)</code></pre>
<pre><code>## Echosounder Summary
## -------------------
## 
## * File source:         &quot;/data/archive/sleiwex/2008/fielddata/2008-07-01/Merlu/Biosonics/20080701_163942.dt4&quot;
## * Transducer serial #: TX03022C
## * File type:           DT4 pre v2.3
## * Beam type:           single-beam
## * Channel:             1
## * Measurements:        2008-07-01 16:39:41 UTC to 2008-07-01 16:42:50 UTC
## * Sound speed:         1490.65 m/s
## * Pulse duration:      0.0004 s
## * Frequency:           418000.000000
## * Blanked samples:     57
## * Pings in file:       780
## * Samples per ping:    3399
## * Time ranges from 2008-07-01 16:39:41 to 2008-07-01 16:42:50 with 190 samples and mean increment 0.9998413 s
## * Data
## 
##                        Min.                Mean                Max.                Dim.   OriginalName
##     timeSlow           2008-07-01 18:39:41 2008-07-01 18:41:15 2008-07-01 18:42:50 190    -           
##     latitudeSlow [°N]  47.879              47.881              47.882              190    -           
##     longitudeSlow [°E] -69.729             -69.726             -69.724             190    -           
##     depth [m]          1.7262              20.687              39.648              54     -           
##     latitude [°N]      47.879              47.881              47.882              389    -           
##     longitude [°E]     -69.729             -69.726             -69.724             389    -           
##     a                  11.325              2492.3              364234              389x54 -           
## 
## * Processing Log
##     - 2016-01-10 16:34:14 UTC: `create &#39;echosounder&#39; object`
##     - 2016-01-10 16:34:15 UTC: `read.echosounder(file = file, processingLog = processingLog)`
##     - 2016-01-10 16:34:15 UTC: `subset.adp(x, subset=depth &lt; 40)`
##     - 2016-01-10 16:34:16 UTC: `decimate(x = echosounder, by = c(2, 40))`</code></pre>
<p>the would generate this plot:</p>
<pre class="r"><code>plot(echosounder, which = 2, drawTimeRange = TRUE, drawBottom = TRUE)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-8"></span>
<img src="/blog/2019-01-16-oce-package-for-oceanographical-data_files/figure-html/unnamed-chunk-8-1.png" alt="3D contour plot of the echosounder." width="672" />
<p class="caption">
Figure 3: 3D contour plot of the echosounder.
</p>
</div>
<p>Echo sounding is a type of sonar used to determine the depth of water by transmitting sound waves into water. But echo sounding can also refer to hydroacoustic “echo sounders” defined as active sound in water (sonar) used to study e.g. fish (commonly applied in fisheries).</p>
<p>In this plot you clearly see the seafloor, which reflects the signal strongest (hence, the red color). The color scale for the amplitude is log10-transformed and trimmed to zero.</p>
</div>
<div id="plot-landsat-objects" class="section level2">
<h2>Plot landsat objects</h2>
<p>Landsat data can be downloaded from the <a href="https://earthexplorer.usgs.gov/">USGS earthexplorer</a> website. The following is a subset of the Landsat-8 image designated LC80080292014065LGN00, an image from March 2014 that covers Nova Scotia and portions of the Bay of Fundy and the Scotian Shelf:</p>
<pre class="r"><code>data(landsat)
landsat</code></pre>
<pre><code>## Landsat object, ID LC80080292014065LGN00 
## Data (bands or calculated):
##   &quot;aerosol&quot; has dimension c(79,80)
##   &quot;blue&quot; has dimension c(79,80)
##   &quot;green&quot; has dimension c(79,80)
##   &quot;red&quot; has dimension c(79,80)
##   &quot;nir&quot; has dimension c(79,80)
##   &quot;swir1&quot; has dimension c(79,80)
##   &quot;swir2&quot; has dimension c(79,80)
##   &quot;panchromatic&quot; has dimension c(158,160)
##   &quot;cirrus&quot; has dimension c(79,80)
##   &quot;tirs1&quot; has dimension c(79,80)
##   &quot;tirs2&quot; has dimension c(79,80)</code></pre>
<pre class="r"><code>plot(landsat, band = &quot;temperature&quot;)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-10"></span>
<img src="/blog/2019-01-16-oce-package-for-oceanographical-data_files/figure-html/unnamed-chunk-10-1.png" alt="Image plot of the landsat data showing the temperature band." width="672" />
<p class="caption">
Figure 4: Image plot of the landsat data showing the temperature band.
</p>
</div>
<p>Using <code>band = &quot;temperature&quot;</code> will plot an estimate of at-satellite brightness temperature, computed from the tirs1 band. Other band options for the Landsat-8 are <code>&quot;aerosol&quot;</code>, <code>&quot;blue&quot;</code>, <code>&quot;green&quot;</code>, <code>&quot;red&quot;</code>, <code>&quot;nir&quot;</code>, <code>&quot;swir1&quot;</code>, <code>&quot;swir2&quot;</code>, <code>&quot;panchromatic&quot;</code>, <code>&quot;cirrus&quot;</code>, <code>&quot;tirs1&quot;</code>, or <code>&quot;tirs2&quot;</code>.</p>
</div>
<div id="plot-coastline-objects" class="section level2">
<h2>Plot coastline objects</h2>
<p><em>oce</em> provides a coastline dataset downloaded from <a href="http://www.naturalearthdata.com">Natural Earth</a>. This dataset has a coarse resolution with a scale of 1:110M and 10,696 points, making it more suitable for world-scale plots plotted at a small size. If you want coastline files with a finer resolution use the <em>ocedata</em> package.</p>
<pre class="r"><code>data(coastlineWorld)
coastlineWorld</code></pre>
<pre><code>## coastline object, from file &#39;/Users/kelley/git/oce/create_data/coastline/ne_110m_admin_0_countries/ne_110m_admin_0_countries.shp&#39;, has data as follows.
##    longitude:     NA, 61.211, ..., 30.323, 29.839 (length 10766)
##    latitude:    NA, 35.65, ..., -22.272, -22.102 (length 10766)</code></pre>
<pre class="r"><code>plot(coastlineWorld)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-12"></span>
<img src="/blog/2019-01-16-oce-package-for-oceanographical-data_files/figure-html/unnamed-chunk-12-1.png" alt="Generic coastline plot with a Cartesian projection." width="672" />
<p class="caption">
Figure 5: Generic coastline plot with a Cartesian projection.
</p>
</div>
<p>If you want to create a map using a specific projection provided by the <a href="">rgdal</a> package, which makes it easy to add more items such as points, lines, contours or text, use the function <code>mapPlot()</code>from <em>oce</em>. Here I will plot the trajectory of the Cook’s Endeavour cruise (provided in the <em>ocedata</em> package) by adding the <code>mapPoints()</code> function:</p>
<pre class="r"><code># load the trajectory data 
data(endeavour, package = &quot;ocedata&quot;)

par(mar = rep(0.5, 4)) # that removes the margin
mapPlot(coastlineWorld, type = &#39;l&#39;, col = &#39;gray&#39;, projection = &quot;+proj=moll&quot;)
# to add points use mapPoint()
mapPoints(endeavour$longitude, endeavour$latitude, pch = 20, col = &#39;red&#39;)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-13"></span>
<img src="/blog/2019-01-16-oce-package-for-oceanographical-data_files/figure-html/unnamed-chunk-13-1.png" alt="Global map with the Mollweide projection (default)." width="672" />
<p class="caption">
Figure 6: Global map with the Mollweide projection (default).
</p>
</div>
<p>You can also add some colors for the topography. The required data is in the dataset <code>topoWorld</code>:</p>
<pre class="r"><code>data(topoWorld)
topo &lt;- decimate(topoWorld, 2) # coarsen grid: 4X faster plot
lon &lt;- topo[[&quot;longitude&quot;]]
lat &lt;- topo[[&quot;latitude&quot;]]
z &lt;- topo[[&quot;z&quot;]]
cm &lt;- colormap(name = &quot;gmt_globe&quot;)
drawPalette(colormap = cm)
par(mar = rep(0.5, 4)) 
mapPlot(coastlineWorld, type = &#39;l&#39;, col = &#39;gray&#39;, projection = &quot;+proj=moll&quot;, grid = FALSE)
mapImage(lon, lat, z, colormap = cm)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-14"></span>
<img src="/blog/2019-01-16-oce-package-for-oceanographical-data_files/figure-html/unnamed-chunk-14-1.png" alt="Global map with added topography." width="672" />
<p class="caption">
Figure 7: Global map with added topography.
</p>
</div>
<p>When zooming into mid-latitude, the Lambert Conformal Conic projection is often used:</p>
<pre class="r"><code>par(mar = c(2, 2, 1, 1))
lonlim &lt;- c(-80, 0)
latlim &lt;- c(20, 60)
mapPlot(coastlineWorld, projection = &quot;+proj=lcc +lat_1=30 +lat_2=50 +lon_0=-40&quot;,
        col = &quot;lightgray&quot;, longitudelim = lonlim, latitudelim = latlim)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-15"></span>
<img src="/blog/2019-01-16-oce-package-for-oceanographical-data_files/figure-html/unnamed-chunk-15-1.png" alt="Map of the North-Atlantic based on the Lambert Conformal Conic projection." width="672" />
<p class="caption">
Figure 8: Map of the North-Atlantic based on the Lambert Conformal Conic projection.
</p>
</div>
<p>See the <code>?mapPlot</code> documentation on the different projections.</p>
</div>
<div id="global-sea-surface-and-temperature-levels-in-2013-from-the-world-ocean-atlas-woa" class="section level2">
<h2>Global sea surface and temperature levels in 2013 from the World Ocean Atlas (WOA)</h2>
<p>The <em>ocedata</em> package has a dataset named <code>levitus</code>, which stores sea-surface temperature (SST) and salinity (SSS) from the 2013 version of the World Ocean Atlas (WOA), commonly referred to as the “Levitus”&quot; atlas (package version 0.1.3):</p>
<pre class="r"><code>data(levitus, package = &quot;ocedata&quot;)
par(mfrow = c(2,1))
imagep(levitus$longitude, levitus$latitude, levitus$SST, col = oceColorsJet, zlim = c(-2, 30))
imagep(levitus$longitude, levitus$latitude, levitus$SSS, col = oceColorsJet, zlim = c(20, 40))</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-16"></span>
<img src="/blog/2019-01-16-oce-package-for-oceanographical-data_files/figure-html/unnamed-chunk-16-1.png" alt="Distribution of annual temperature (top) and salinity (bottom) levels in 2013 (original source WOA)." width="672" />
<p class="caption">
Figure 9: Distribution of annual temperature (top) and salinity (bottom) levels in 2013 (original source WOA).
</p>
</div>
</div>
<div id="more-infos" class="section level2">
<h2>More infos</h2>
<p>For more information on the different plotting settings see the general plot help by typing one of the different plot methods, e.g. <code>?plot,ctd-method</code>. Since the <em>oce</em> plot function produces various different type of plots, it is a bit tricky though to figure out which arguments are useful for which type of plot.</p>
<p>If you want to learn more about the package, I highly recommend the <em>oce</em> <a href="https://cran.r-project.org/web/packages/oce/vignettes/oce.html">vignette</a> and the github documentation page: <a href="https://cran.r-project.org/web/packages/oce/vignettes/oce.html" class="uri">https://cran.r-project.org/web/packages/oce/vignettes/oce.html</a>. Dan Kelly, the author of the package, also wrote the book <a href="https://www.springer.com/us/book/9781493988426">Oceanographic Analysis with R</a> where the package is described in great detail.</p>
</div>
